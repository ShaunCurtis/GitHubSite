<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Part 5 - View Components - CRUD List Operations in the UI | Cold Elm Coders</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.dd68a41e.css" as="style"><link rel="preload" href="/assets/js/app.0784ea42.js" as="script"><link rel="preload" href="/assets/js/3.36dc20da.js" as="script"><link rel="preload" href="/assets/js/16.e30cd155.js" as="script"><link rel="prefetch" href="/assets/js/10.b9150889.js"><link rel="prefetch" href="/assets/js/11.e135ddc5.js"><link rel="prefetch" href="/assets/js/12.f7a15c90.js"><link rel="prefetch" href="/assets/js/13.3853eda2.js"><link rel="prefetch" href="/assets/js/14.0e4ef0bd.js"><link rel="prefetch" href="/assets/js/15.2319b6a1.js"><link rel="prefetch" href="/assets/js/17.3c9aa520.js"><link rel="prefetch" href="/assets/js/18.1d0bae0d.js"><link rel="prefetch" href="/assets/js/19.40396d12.js"><link rel="prefetch" href="/assets/js/2.d8f0ea9c.js"><link rel="prefetch" href="/assets/js/20.5255d394.js"><link rel="prefetch" href="/assets/js/21.28affb46.js"><link rel="prefetch" href="/assets/js/22.dba79a01.js"><link rel="prefetch" href="/assets/js/23.02383450.js"><link rel="prefetch" href="/assets/js/24.4367ae2b.js"><link rel="prefetch" href="/assets/js/25.2db7d111.js"><link rel="prefetch" href="/assets/js/26.66b39366.js"><link rel="prefetch" href="/assets/js/27.73333f76.js"><link rel="prefetch" href="/assets/js/28.f57d772c.js"><link rel="prefetch" href="/assets/js/29.75fe04f9.js"><link rel="prefetch" href="/assets/js/30.4fa924f3.js"><link rel="prefetch" href="/assets/js/31.3bc4b09a.js"><link rel="prefetch" href="/assets/js/32.e73a9df8.js"><link rel="prefetch" href="/assets/js/33.3c5c3e6d.js"><link rel="prefetch" href="/assets/js/34.26f37993.js"><link rel="prefetch" href="/assets/js/35.6fd0d388.js"><link rel="prefetch" href="/assets/js/36.d4a64a71.js"><link rel="prefetch" href="/assets/js/37.6a94a955.js"><link rel="prefetch" href="/assets/js/38.889dc17c.js"><link rel="prefetch" href="/assets/js/39.975067e9.js"><link rel="prefetch" href="/assets/js/4.e0f17090.js"><link rel="prefetch" href="/assets/js/40.4f36b71b.js"><link rel="prefetch" href="/assets/js/5.19ad076b.js"><link rel="prefetch" href="/assets/js/6.7cbf098b.js"><link rel="prefetch" href="/assets/js/7.b3f67ab4.js"><link rel="prefetch" href="/assets/js/8.39d73ebe.js"><link rel="prefetch" href="/assets/js/9.756a2b3d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.dd68a41e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Cold Elm Coders</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/articles/" class="nav-link">
  Articles
</a></div><div class="nav-item"><a href="/posts/" class="nav-link">
  Posts
</a></div><div class="nav-item"><a href="/Building-a-Database-Application-in-Blazor/" class="nav-link router-link-active">
  Database Application
</a></div><div class="nav-item"><a href="https://cec-blazor-examples.azurewebsites.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/articles/" class="nav-link">
  Articles
</a></div><div class="nav-item"><a href="/posts/" class="nav-link">
  Posts
</a></div><div class="nav-item"><a href="/Building-a-Database-Application-in-Blazor/" class="nav-link router-link-active">
  Database Application
</a></div><div class="nav-item"><a href="https://cec-blazor-examples.azurewebsites.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Blazor Database Application</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Building-a-Database-Application-in-Blazor/" aria-current="page" class="sidebar-link">Building a Database Application in Blazor</a></li><li><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-1.html" class="sidebar-link">Part 1 - Project Structure and Framework</a></li><li><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-2.html" class="sidebar-link">Part 2 - Services - Building the CRUD Data Layers</a></li><li><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-3.html" class="sidebar-link">Part 3 - View Components - CRUD Edit and View Operations in the UI</a></li><li><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" class="sidebar-link">Part 4 - UI Components</a></li><li><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html" aria-current="page" class="active sidebar-link">Part 5 - View Components - CRUD List Operations in the UI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html#part-5-view-components-crud-list-operations-in-the-ui" class="sidebar-link">Part 5 - View Components - CRUD List Operations in the UI</a></li><li class="sidebar-sub-header"><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html#repository-and-database" class="sidebar-link">Repository and Database</a></li><li class="sidebar-sub-header"><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html#list-functionality" class="sidebar-link">List Functionality</a></li><li class="sidebar-sub-header"><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html#the-base-forms" class="sidebar-link">The Base Forms</a></li><li class="sidebar-sub-header"><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-5.html#history" class="sidebar-link">History</a></li></ul></li><li><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html" class="sidebar-link">Part 6 - Adding new Record Types and Their UI to the Weather Application</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="building-a-database-application-in-blazor"><a href="#building-a-database-application-in-blazor" class="header-anchor">#</a> Building a Database Application in Blazor</h1> <h2 id="part-5-view-components-crud-list-operations-in-the-ui"><a href="#part-5-view-components-crud-list-operations-in-the-ui" class="header-anchor">#</a> Part 5 - View Components - CRUD List Operations in the UI</h2> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>This is the fifth in the series looking at how to build and structure a real Database Application in Blazor. The articles so far are:</p> <ol><li>Project Structure and Framework.</li> <li>Services - Building the CRUD Data Layers.</li> <li>View Components - CRUD Edit and View Operations in the UI.</li> <li>UI Components - Building HTML/CSS Controls.</li> <li>View Components - CRUD List Operations in the UI.</li> <li>A walk through detailing how to add weather stations and weather station data to the application.</li></ol> <p>Further articles:</p> <ul><li>A walk through detailing how to add more records to the application - in this case weather stations and weather station data.</li></ul> <p>This article looks in detail at building reusable List Presentation Layer components and deploying them in both Server and WASM projects.</p> <h2 id="repository-and-database"><a href="#repository-and-database" class="header-anchor">#</a> Repository and Database</h2> <p>The repository for the articles has move to <a href="https://github.com/ShaunCurtis/CEC.Blazor.SPA" target="_blank" rel="noopener noreferrer">CEC.Blazor.SPA Repository<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.  <a href="https://github.com/ShaunCurtis/CEC.Blazor" target="_blank" rel="noopener noreferrer">CEC.Blazor GitHub Repository<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is obselete and will be removed.</p> <p>There's a SQL script in /SQL in the repository for building the database.</p> <p><a href="https://cec-blazor-server.azurewebsites.net/" target="_blank" rel="noopener noreferrer">You can see the Server and WASM versions of the project running here on the same site<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Serveral classes described here are part of the separate <em>CEC.Blazor.Core</em> library.  The Github is <a href="https://github.com/ShaunCurtis/CEC.Blazor.Core" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, and is available as a Nuget Package.</p> <h2 id="list-functionality"><a href="#list-functionality" class="header-anchor">#</a> List Functionality</h2> <p>List components present far more challenges than other CRUD components.  Functionality expected in a professional level list control includes:</p> <ul><li>Paging to handle large data sets</li> <li>Column formatting to control column width and data overflow</li> <li>Sorting on individual columns</li> <li>Filtering</li></ul> <h2 id="the-base-forms"><a href="#the-base-forms" class="header-anchor">#</a> The Base Forms</h2> <p><code>ListFormBase</code> is the base form for all lists. It inherits from <code>ControllerServiceFormBase</code>.</p> <p>Not all the code is shown in the article - some class are simply too big and I only show the most relevant sections.  All source files can be viewed on the Github site, and I include references or links to specific code files at appropriate places in the article.  Much of the detail on what sections of code do is in the code comments.</p> <h3 id="paging"><a href="#paging" class="header-anchor">#</a> Paging</h3> <p>Paging is implemented through the <code>IControllerPagingService</code> interface. <code>BaseControllerService</code> implements this interface.  It's not shown in detail here because it's too big.  Much of the functionality is pretty obvious - properties to track which page your on, how many pages and blocks you have, page size, etc - so we'll skip to the more interesting sections.</p> <h4 id="initial-form-loading"><a href="#initial-form-loading" class="header-anchor">#</a> Initial Form Loading</h4> <p>Lets start with loading a list form and look at <code>OnRenderAsync</code>.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Weather/Components/Forms/WeatherForecastListForm.razor.cs</span>
<span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">OnRenderAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> firstRender<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Sets the specific service</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Service <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ControllerService<span class="token punctuation">;</span>
        <span class="token comment">// Sets the max column</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>UIOptions<span class="token punctuation">.</span>MaxColumn <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">OnRenderAsync</span><span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Components/BaseForms/ListFormBase.cs</span>
<span class="token keyword">protected</span> <span class="token keyword">async</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">OnRenderAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> firstRender<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// set the page to 1</span>
    <span class="token class-name"><span class="token keyword">var</span></span> page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>IsService<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Reset the Service if this is the first load</span>
            <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Service<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>ListTitle <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ListTitle<span class="token punctuation">)</span> <span class="token punctuation">?</span> <span class="token interpolation-string"><span class="token string">$&quot;List of </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token keyword">this</span><span class="token punctuation">.</span>Service<span class="token punctuation">.</span>RecordConfiguration<span class="token punctuation">.</span>RecordListDecription</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ListTitle<span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token comment">// Load the filters for the recordset</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">LoadFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Check if we have a saved Page No in the ViewData</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>IsViewManager <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>ViewManager<span class="token punctuation">.</span>ViewData<span class="token punctuation">.</span><span class="token function">GetFieldAsInt</span><span class="token punctuation">(</span><span class="token string">&quot;Page&quot;</span><span class="token punctuation">,</span> <span class="token keyword">out</span> page<span class="token punctuation">)</span><span class="token punctuation">)</span> page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token comment">// Load the paged recordset</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Service<span class="token punctuation">.</span><span class="token function">LoadPagingAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// go to the correct page</span>
        <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span><span class="token function">GoToPageAsync</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">await</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">OnRenderAsync</span><span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Components/BaseForms/FormBase.cs</span>
<span class="token keyword">protected</span> <span class="token keyword">async</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">OnRenderAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> firstRender<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">GetUserAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">await</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">OnRenderAsync</span><span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// base LoadFilter</span>
<span class="token keyword">protected</span> <span class="token keyword">virtual</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Set OnlyLoadIfFilter if the Parameter value is set</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>IsService<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Service<span class="token punctuation">.</span>FilterList<span class="token punctuation">.</span>OnlyLoadIfFilters <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>OnlyLoadIfFilter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We're interested in <code>ListFormBase</code> calling <code>LoadPagingAsync()</code></p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Components/BaseForms/ListComponentBase.cs</span>

<span class="token comment">/// Method to load up the Paged Data to display</span>
<span class="token comment">/// loads the delegate with the default service GetDataPage method and loads the first page</span>
<span class="token comment">/// Can be overridden for more complex situations</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token keyword">virtual</span> <span class="token return-type class-name">Task</span> <span class="token function">LoadPagingAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// set the record to null to force a reload of the records</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>Records <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">// if requested adds a default service function to the delegate</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>PageLoaderAsync <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">IControllerPagingService<span class="token punctuation">&lt;</span>TRecord<span class="token punctuation">&gt;</span><span class="token punctuation">.</span>PageLoaderDelegateAsync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>GetDataPageWithSortingAsync<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// loads the paging object</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">LoadAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Trigger event so any listeners get notified</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">TriggerListChangedEvent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>IControllerPagingService</code> defines a delegate <code>PageLoaderDelegateAsync</code> which returns a List of TRecords, and a delegate property <code>PageLoaderAsync</code>.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Services/Interfaces/IControllerPagingService.cs</span>

<span class="token comment">// Delegate that returns a generic Record List</span>
<span class="token keyword">public</span> <span class="token keyword">delegate</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>List<span class="token punctuation">&lt;</span>TRecord<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">PageLoaderDelegateAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Holds the reference to the PageLoader Method to use</span>
<span class="token keyword">public</span> <span class="token return-type class-name">PageLoaderDelegateAsync</span> PageLoaderAsync <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>By default, <code>LoadPagingAsync</code> loads the method <code>GetDataPageWithSortingAsync</code> as <code>PageLoaderAsync</code>, and then calls <code>LoadAsync</code>.</p> <p><code>LoadAsync</code> resets various properties (We did this in <code>OnRenderAsync</code> by resetting the service, but <code>LoadAsync</code> is called from elsewhere where we need to reset the record list - but not the whole service), and calls the <code>PageLoaderAsync</code> delegate.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Services/BaseControllerService.cs</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> <span class="token function">LoadAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Reset the page to 1</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// Check if we have a sort column, if not set to the default column</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>DefaultSortColumn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>SortColumn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>DefaultSortColumn<span class="token punctuation">;</span>
    <span class="token comment">// Set the sort direction to the default</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>SortingDirection <span class="token operator">=</span> DefaultSortingDirection<span class="token punctuation">;</span>
    <span class="token comment">// Check if we have a method loaded in the PageLoaderAsync delegate and if so run it</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PageLoaderAsync <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>PagedRecords <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">PageLoaderAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Set the block back to the start</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ChangeBlock</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//  Force a UI update as everything has changed</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>PageHasChanged<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>GetDataPageWithSortingAsync</code> is shown below.  See the comments for detail. <code>GetFilteredListAsync</code> is always called to refresh the list recordset if necessary.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Services/BaseControllerService.cs</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token keyword">virtual</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>List<span class="token punctuation">&lt;</span>TRecord<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetDataPageWithSortingAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Get the filtered list - will only get a new list if the Records property has been set to null elsewhere</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">GetFilteredListAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Reset the start record if we are outside the range of the record set - a belt and braces check as this shouldn't happen!</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PageStartRecord <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Records<span class="token punctuation">.</span>Count<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// Check if we have to apply sorting, in not get the page we want</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>SortColumn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Records<span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PageStartRecord<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_PageSize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//  If we do order the record set and then get the page we want</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>SortingDirection <span class="token operator">==</span> SortDirection<span class="token punctuation">.</span>Ascending<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Records<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>SortColumn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PageStartRecord<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_PageSize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Records<span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>SortColumn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Skip</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PageStartRecord<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Take</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_PageSize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>GetFilteredListAsync</code> gets a filter list recordset.  It's overridden in form components where filtering is applied - such as from a filter control.  The default implementation gets the full recordset.  It uses <code>IsRecords</code> to check if it needs to reload the recordset.  It only reloads if <code>Records</code> is null.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Services/BaseControllerService.cs</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token keyword">virtual</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> <span class="token function">GetFilteredListAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Check if the record set is null. and only refresh the record set if it's null</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>IsRecords<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//gets the filtered record list</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Records <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Service<span class="token punctuation">.</span><span class="token function">GetFilteredRecordListAsync</span><span class="token punctuation">(</span>FilterList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To summarise:</p> <ol><li>On Form loading <code>Service</code> (the specific data service for the record type) gets reset.</li> <li><code>GetDataPageWithSortingAsync()</code> on the <code>Service</code> gets loaded into the <code>Service</code> delegate</li> <li>The Delegate gets called with <code>Records</code> in the <code>Service</code> set to null</li> <li><code>GetFilteredListAsync()</code> loads <code>Records</code></li> <li><code>GetDataPageWithSortingAsync()</code> loads the first page</li> <li><code>IsLoading</code> is set to false so the <code>UIErrorHandler</code> UI control displays the page.</li> <li>The Form is refreshed after <code>OnParametersSetAsync</code> automatically so no manual call to <code>StateHasChanged</code> is required. <code>OnInitializedAsync</code> is part of <code>OnParametersSetAsync</code> and only completes when <code>OnInitializedAsync</code> completes.</li></ol> <h4 id="form-events"><a href="#form-events" class="header-anchor">#</a> Form Events</h4> <p>The <code>PagingControl</code> interfaces directly with the Form <code>Service</code> through the <code>IPagingControlService</code> interface, and links button clicks to <code>IPagingControlService</code> methods:</p> <ol><li><code>ChangeBlockAsync(int direction,bool supresspageupdate)</code></li> <li><code>MoveOnePageAsync(int direction)</code></li> <li><code>GoToPageAsync(int pageno)</code></li></ol> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Services/BaseControllerService.cs</span>

<span class="token comment">/// Moves forward or backwards one block</span>
<span class="token comment">/// direction 1 for forwards</span>
<span class="token comment">/// direction -1 for backwards</span>
<span class="token comment">/// suppresspageupdate </span>
<span class="token comment">///  - set to true (default) when user changes page and the block changes with the page</span>
<span class="token comment">///  - set to false when user changes block rather than changing page and the page needs to be updated to the first page of the block</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">ChangeBlockAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> direction<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">bool</span></span> suppresspageupdate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>direction <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>TotalPages<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>PagingBlockSize <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>TotalPages<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>PagingBlockSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>TotalPages<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>suppresspageupdate<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>direction <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>PagingBlockSize<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>suppresspageupdate<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>direction <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>PagingBlockSize <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>TotalPages<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>PagingBlockSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>TotalPages<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>suppresspageupdate<span class="token punctuation">)</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">PaginateAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">/// Moves forward or backwards one page</span>
<span class="token comment">/// direction 1 for forwards</span>
<span class="token comment">/// direction -1 for backwards</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">MoveOnePageAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> direction<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>direction <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>TotalPages<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>EndPage<span class="token punctuation">)</span> <span class="token keyword">await</span> <span class="token function">ChangeBlockAsync</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>direction <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>StartPage<span class="token punctuation">)</span> <span class="token keyword">await</span> <span class="token function">ChangeBlockAsync</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">PaginateAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">/// Moves to the specified page</span>
<span class="token keyword">public</span> Async <span class="token return-type class-name">Task</span> <span class="token function">GoToPageAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> pageno<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage <span class="token operator">=</span> pageno<span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">PaginateAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>All the above methods set up the <code>IPagingControlService</code> properties and then call <code>PaginateAsync()</code> which calls the PageLoaderAsync delegate and forces a UI update.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Services/BaseControllerService.cs</span>

<span class="token comment">/// Method to trigger the page Changed Event</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">PaginateAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Check if we have a method loaded in the PageLoaderAsync delegate and if so run it</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PageLoaderAsync <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>PagedRecords <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">PageLoaderAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//  Force a UI update as something has changed</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>PageHasChanged<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>CurrentPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="pagecontrol"><a href="#pagecontrol" class="header-anchor">#</a> PageControl</h4> <p>The <code>PageControl</code> code is shown below and documented with comments.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Components/FormControls/PagingControl.razor</span>

@<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>IsPagination<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pagination ml-2 flex-nowrap&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>nav aria<span class="token operator">-</span>label<span class="token operator">=</span><span class="token string">&quot;Page navigation&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>ul <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pagination mb-1&quot;</span><span class="token operator">&gt;</span>
                @<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>DisplayType <span class="token operator">!=</span> PagingDisplayType<span class="token punctuation">.</span>Narrow<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    @<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>DisplayType <span class="token operator">==</span> PagingDisplayType<span class="token punctuation">.</span>FullwithoutPageSize<span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.ChangeBlockAsync(-1, false))&quot;</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&amp;</span>laquo<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{</span>
                        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.ChangeBlockAsync(-1, false))&quot;</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span>laquo<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    <span class="token punctuation">}</span>
                    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.MoveOnePageAsync(-1))&quot;</span><span class="token operator">&gt;</span>Previous<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    @<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>StartPage<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>EndPage<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token class-name"><span class="token keyword">var</span></span> currentpage <span class="token operator">=</span> i<span class="token punctuation">;</span>
                        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item @(currentpage == this.Paging.CurrentPage ? &quot;</span>active<span class="token string">&quot; : &quot;</span>&quot;<span class="token punctuation">)</span><span class="token string">&quot;&gt;&lt;button class=&quot;</span>page<span class="token operator">-</span>link<span class="token string">&quot; @onclick=&quot;</span><span class="token punctuation">(</span>e <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span><span class="token function">GoToPageAsync</span><span class="token punctuation">(</span>currentpage<span class="token punctuation">)</span><span class="token punctuation">)</span>&quot;<span class="token operator">&gt;</span>@currentpage<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    <span class="token punctuation">}</span>
                    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.MoveOnePageAsync(1))&quot;</span><span class="token operator">&gt;</span>Next<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    @<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>DisplayType <span class="token operator">==</span> PagingDisplayType<span class="token punctuation">.</span>FullwithoutPageSize<span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.ChangeBlockAsync(1, false))&quot;</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span>raquo<span class="token punctuation">;</span>@<span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>TotalPages<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{</span>
                        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.ChangeBlockAsync(1, false))&quot;</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span>raquo<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{</span>
                    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.MoveOnePageAsync(-1))&quot;</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&amp;</span>laquo<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    @<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>StartPage<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>EndPage<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token class-name"><span class="token keyword">var</span></span> currentpage <span class="token operator">=</span> i<span class="token punctuation">;</span>
                        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item @(currentpage == this.Paging.CurrentPage ? &quot;</span>active<span class="token string">&quot; : &quot;</span>&quot;<span class="token punctuation">)</span><span class="token string">&quot;&gt;&lt;button class=&quot;</span>page<span class="token operator">-</span>link<span class="token string">&quot; @onclick=&quot;</span><span class="token punctuation">(</span>e <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span><span class="token function">GoToPageAsync</span><span class="token punctuation">(</span>currentpage<span class="token punctuation">)</span><span class="token punctuation">)</span>&quot;<span class="token operator">&gt;</span>@currentpage<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                    <span class="token punctuation">}</span>
                    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-item&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;page-link&quot;</span> @onclick<span class="token operator">=</span><span class="token string">&quot;(e =&gt; this.Paging.MoveOnePageAsync(1))&quot;</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span>raquo<span class="token punctuation">;</span>@<span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>TotalPages<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
                <span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>nav<span class="token operator">&gt;</span>
        @<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>DisplayType <span class="token operator">==</span> PagingDisplayType<span class="token punctuation">.</span>Full<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pagebutton btn btn-link btn-sm disabled mr-1&quot;</span><span class="token operator">&gt;</span>Page @<span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>CurrentPage of @<span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>TotalPages<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Blazor/Components/FormControls/PagingControl.razor.cs</span>

<span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">PagingControl<span class="token punctuation">&lt;</span>TRecord<span class="token punctuation">&gt;</span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ComponentBase</span></span> <span class="token keyword">where</span> <span class="token class-name">TRecord</span> <span class="token punctuation">:</span> IDbRecord<span class="token operator">&lt;</span>TRecord<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CascadingParameter</span></span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token return-type class-name">IControllerPagingService<span class="token punctuation">&lt;</span>TRecord<span class="token punctuation">&gt;</span></span> _Paging <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Parameter</span></span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token return-type class-name">IControllerPagingService<span class="token punctuation">&lt;</span>TRecord<span class="token punctuation">&gt;</span></span> Paging <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Parameter</span></span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token return-type class-name">PagingDisplayType</span> DisplayType <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> PagingDisplayType<span class="token punctuation">.</span>Full<span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Parameter</span></span><span class="token punctuation">]</span> <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> BlockSize <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> IsPaging <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> IsPagination <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>IsPagination<span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">OnRenderAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> firstRender<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Check if we have a cascaded IControllerPagingService if so use it</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Paging <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_Paging <span class="token operator">??</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>IsPaging<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>PageHasChanged <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>UpdateUI<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>DisplayType <span class="token operator">==</span> PagingDisplayType<span class="token punctuation">.</span>Narrow<span class="token punctuation">)</span> Paging<span class="token punctuation">.</span>PagingBlockSize <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>BlockSize <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> Paging<span class="token punctuation">.</span>PagingBlockSize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>BlockSize<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">OnRenderAsync</span><span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">async</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateUI</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> recordno<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">await</span> <span class="token function">RenderAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">IsCurrent</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> i <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Paging<span class="token punctuation">.</span>CurrentPage <span class="token punctuation">?</span> <span class="token string">&quot;active&quot;</span> <span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="weatherforecastlistform"><a href="#weatherforecastlistform" class="header-anchor">#</a> WeatherForecastListForm</h4> <p>The Code for the <code>WeatherForecastListForm</code> is fairly self explanatory.  <code>OnView</code> and <code>OnEdit</code> either route to the Viewer or Editor, or open the dialogs if <code>UIOptions</code> specifies Use Modals.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Weather/Components/Forms/WeatherForecastListForm.razor.cs</span>

<span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">WeatherForecastListForm</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ListFormBase<span class="token punctuation">&lt;</span>DbWeatherForecast<span class="token punctuation">,</span> WeatherForecastDbContext<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token comment">/// The Injected Controller service for this record</span>
    <span class="token punctuation">[</span>Inject<span class="token punctuation">]</span> <span class="token keyword">protected</span> <span class="token return-type class-name">WeatherForecastControllerService</span> ControllerService <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">Task</span> <span class="token function">OnRenderAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> firstRender<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Sets the specific service</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Service <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ControllerService<span class="token punctuation">;</span>
            <span class="token comment">// Sets the max column</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>UIOptions<span class="token punctuation">.</span>MaxColumn <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">OnRenderAsync</span><span class="token punctuation">(</span>firstRender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/// Method called when the user clicks on a row in the viewer.</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnView</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> id<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>UIOptions<span class="token punctuation">.</span>UseModalViewer <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ViewManager<span class="token punctuation">.</span>ModalDialog <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OnModalAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>WeatherForecastViewerForm<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OnViewAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>WeatherForecastViewerView<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/// Method called when the user clicks on a row Edit button.</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnEdit</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> id<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>UIOptions<span class="token punctuation">.</span>UseModalViewer <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ViewManager<span class="token punctuation">.</span>ModalDialog <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OnModalAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>WeatherForecastEditorForm<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">OnViewAsync</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>WeatherForecastEditorView<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The Razor Markup below is an abbreviated version of the full file.  This makes extensive use of UIControls which were covered in the previous article.  See the comments for detail.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Weather/Components/Forms/WeatherForecastListForm.razor</span>

<span class="token comment">// Wrapper that cascades the values including event handlers</span>
<span class="token operator">&lt;</span><span class="token class-name">UIWrapper</span> UIOptions<span class="token operator">=</span><span class="token string">&quot;@this.UIOptions&quot;</span> RecordConfiguration<span class="token operator">=</span><span class="token string">&quot;@this.Service.RecordConfiguration&quot;</span> OnView<span class="token operator">=</span><span class="token string">&quot;@OnView&quot;</span> OnEdit<span class="token operator">=</span><span class="token string">&quot;@OnEdit&quot;</span><span class="token operator">&gt;</span>

    <span class="token comment">// UI CardGrid is a Bootstrap Card</span>
    <span class="token operator">&lt;</span><span class="token class-name">UICardGrid</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span> IsCollapsible<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> Paging<span class="token operator">=</span><span class="token string">&quot;this.Paging&quot;</span> IsLoading<span class="token operator">=</span><span class="token string">&quot;this.Loading&quot;</span><span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>Title<span class="token operator">&gt;</span>
            @<span class="token keyword">this</span><span class="token punctuation">.</span>ListTitle
        <span class="token operator">&lt;</span><span class="token operator">/</span>Title<span class="token operator">&gt;</span>

        <span class="token comment">// Header Section of UICardGrid</span>
        <span class="token operator">&lt;</span>TableHeader<span class="token operator">&gt;</span>
            <span class="token comment">// Header Grid columns</span>
            <span class="token operator">&lt;</span><span class="token class-name">UIGridTableHeaderColumn</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span> Column<span class="token operator">=</span><span class="token string">&quot;1&quot;</span> FieldName<span class="token operator">=</span><span class="token string">&quot;WeatherForecastID&quot;</span><span class="token operator">&gt;</span>ID<span class="token operator">&lt;</span><span class="token operator">/</span>UIGridTableHeaderColumn<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token class-name">UIGridTableHeaderColumn</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span> Column<span class="token operator">=</span><span class="token string">&quot;2&quot;</span> FieldName<span class="token operator">=</span><span class="token string">&quot;Date&quot;</span><span class="token operator">&gt;</span>Date<span class="token operator">&lt;</span><span class="token operator">/</span>UIGridTableHeaderColumn<span class="token operator">&gt;</span>
            <span class="token range operator">..</span><span class="token range operator">..</span><span class="token punctuation">.</span>
            <span class="token operator">&lt;</span><span class="token class-name">UIGridTableHeaderColumn</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span> Column<span class="token operator">=</span><span class="token string">&quot;7&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>UIGridTableHeaderColumn<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>TableHeader<span class="token operator">&gt;</span>

        <span class="token comment">// Row Template Section of UICardGrid</span>
        <span class="token operator">&lt;</span>RowTemplate<span class="token operator">&gt;</span>
            <span class="token comment">// Cascaded ID for the specific Row</span>
            <span class="token operator">&lt;</span><span class="token class-name">CascadingValue</span> Name<span class="token operator">=</span><span class="token string">&quot;RecordID&quot;</span> Value<span class="token operator">=</span><span class="token string">&quot;@context.WeatherForecastID&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token class-name">UIGridTableColumn</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span> Column<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span>@context<span class="token punctuation">.</span>WeatherForecastID<span class="token operator">&lt;</span><span class="token operator">/</span>UIGridTableColumn<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token class-name">UIGridTableColumn</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span> Column<span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token operator">&gt;</span>@context<span class="token punctuation">.</span>Date<span class="token punctuation">.</span><span class="token function">ToShortDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>UIGridTableColumn<span class="token operator">&gt;</span>
                <span class="token range operator">..</span><span class="token range operator">..</span><span class="token punctuation">.</span>
                <span class="token operator">&lt;</span><span class="token class-name">UIGridTableEditColumn</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>UIGridTableEditColumn<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>CascadingValue<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span><span class="token operator">/</span>RowTemplate<span class="token operator">&gt;</span>
        <span class="token comment">// Navigation Section of UUCardGrid</span>
        <span class="token operator">&lt;</span>Navigation<span class="token operator">&gt;</span>

            <span class="token operator">&lt;</span>UIListButtonRow<span class="token operator">&gt;</span>
                <span class="token comment">// Paging part of UIListButtonRow</span>
                <span class="token operator">&lt;</span>Paging<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token class-name">PagingControl</span> TRecord<span class="token operator">=</span><span class="token string">&quot;DbWeatherForecast&quot;</span> Paging<span class="token operator">=</span><span class="token string">&quot;this.Paging&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>PagingControl<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>Paging<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>UIListButtonRow<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span><span class="token operator">/</span>Navigation<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>UICardGrid<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>UIWrapper<span class="token operator">&gt;</span>
</code></pre></div><p>The Razor component uses a set of UIControls designed for list building.  <code>UICardGrid</code> builds the Bootstrap Card and the table framework.  You can explore the components code in the Github Repository.</p> <h4 id="weatherforcastlistmodalview"><a href="#weatherforcastlistmodalview" class="header-anchor">#</a> WeatherForcastListModalView</h4> <p>This is pretty simple.  Razor markup for a <code>WeatherForecastListForm</code> and a <code>UIOptions</code> object.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// CEC.Weather/Components/Views/WeatherForecastListModalView.razor</span>

@<span class="token keyword">using</span> CEC<span class="token punctuation">.</span>Blazor<span class="token punctuation">.</span>Components
@<span class="token keyword">using</span> CEC<span class="token punctuation">.</span>Blazor<span class="token punctuation">.</span>Components<span class="token punctuation">.</span>BaseForms
@<span class="token keyword">using</span> CEC<span class="token punctuation">.</span>Blazor<span class="token punctuation">.</span>Components<span class="token punctuation">.</span>UIControls
@<span class="token keyword">using</span> CEC<span class="token punctuation">.</span>Weather<span class="token punctuation">.</span>Data
@<span class="token keyword">using</span> CEC<span class="token punctuation">.</span>Weather<span class="token punctuation">.</span>Components
@<span class="token keyword">using</span> CEC<span class="token punctuation">.</span>Blazor<span class="token punctuation">.</span>Components<span class="token punctuation">.</span>Base

@<span class="token keyword">namespace</span> CEC<span class="token punctuation">.</span>Weather<span class="token punctuation">.</span>Components<span class="token punctuation">.</span>Views

@inherits Component
@implements IView

<span class="token operator">&lt;</span><span class="token class-name">WeatherForecastListForm</span> UIOptions<span class="token operator">=</span><span class="token string">&quot;this.UIOptions&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>WeatherForecastListForm<span class="token operator">&gt;</span>

@code <span class="token punctuation">{</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CascadingParameter</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ViewManager</span> ViewManager <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">UIOptions</span> UIOptions <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">UIOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ListNavigationToViewer <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        ShowButtons <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        ShowAdd <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        ShowEdit <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        UseModalEditor <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        UseModalViewer <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="wrap-up"><a href="#wrap-up" class="header-anchor">#</a> Wrap Up</h3> <p>That wraps up this article.  Some key points to note:</p> <ol><li>There's no differences in code between a Blazor Server and a Blazor WASM.</li> <li>Almost all functionality is implemented in the library components.  Most of the application code is Razor markup for the individual record fields.</li> <li>Async functionality is used throughout the components and CRUD data access.</li></ol> <h2 id="history"><a href="#history" class="header-anchor">#</a> History</h2> <ul><li>25-Sep-2020: Initial version.</li> <li>17-Nov-2020: Major Blazor.CEC library changes.  Change to ViewManager from Router and new Component base implementation.</li> <li>7-Feb-2021: Major updates to Services, project structure and data editing.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-4.html" class="prev">
        Part 4 - UI Components
      </a></span> <span class="next"><a href="/Building-a-Database-Application-in-Blazor/Building-a-Database-Application-in-Blazor-Part-6.html">
        Part 6 - Adding new Record Types and Their UI to the Weather Application
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0784ea42.js" defer></script><script src="/assets/js/3.36dc20da.js" defer></script><script src="/assets/js/16.e30cd155.js" defer></script>
  </body>
</html>
