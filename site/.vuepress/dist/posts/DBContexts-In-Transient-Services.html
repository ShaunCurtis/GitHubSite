<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>No to DbContexts in Transient Services | Cold Elm Coders</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.44eeee96.css" as="style"><link rel="preload" href="/assets/js/app.cabad5b2.js" as="script"><link rel="preload" href="/assets/js/3.3d8b86b8.js" as="script"><link rel="preload" href="/assets/js/50.98d6ed4c.js" as="script"><link rel="prefetch" href="/assets/js/1.3b0fc1ec.js"><link rel="prefetch" href="/assets/js/10.a274dc46.js"><link rel="prefetch" href="/assets/js/11.162f7736.js"><link rel="prefetch" href="/assets/js/12.c08de670.js"><link rel="prefetch" href="/assets/js/13.b0705d6f.js"><link rel="prefetch" href="/assets/js/14.00c4752d.js"><link rel="prefetch" href="/assets/js/15.45d86c85.js"><link rel="prefetch" href="/assets/js/16.30ac41f9.js"><link rel="prefetch" href="/assets/js/17.8ae04617.js"><link rel="prefetch" href="/assets/js/18.343bc460.js"><link rel="prefetch" href="/assets/js/19.e6db8bd1.js"><link rel="prefetch" href="/assets/js/20.30ace146.js"><link rel="prefetch" href="/assets/js/21.02b7ea19.js"><link rel="prefetch" href="/assets/js/22.37238a7b.js"><link rel="prefetch" href="/assets/js/23.16adf976.js"><link rel="prefetch" href="/assets/js/24.074dd2be.js"><link rel="prefetch" href="/assets/js/25.8115fc0d.js"><link rel="prefetch" href="/assets/js/26.3ab38710.js"><link rel="prefetch" href="/assets/js/27.8e5f49aa.js"><link rel="prefetch" href="/assets/js/28.6895cc2f.js"><link rel="prefetch" href="/assets/js/29.d04ce041.js"><link rel="prefetch" href="/assets/js/30.5cafb6de.js"><link rel="prefetch" href="/assets/js/31.5354aaa0.js"><link rel="prefetch" href="/assets/js/32.07ead7c6.js"><link rel="prefetch" href="/assets/js/33.24f6101a.js"><link rel="prefetch" href="/assets/js/34.83c8ebf2.js"><link rel="prefetch" href="/assets/js/35.4b0767ce.js"><link rel="prefetch" href="/assets/js/36.7b21c9b5.js"><link rel="prefetch" href="/assets/js/37.66a33bc2.js"><link rel="prefetch" href="/assets/js/38.6cd5ef3d.js"><link rel="prefetch" href="/assets/js/39.14f11fb3.js"><link rel="prefetch" href="/assets/js/4.0476436c.js"><link rel="prefetch" href="/assets/js/40.48643f42.js"><link rel="prefetch" href="/assets/js/41.31c3bda3.js"><link rel="prefetch" href="/assets/js/42.9b5073d7.js"><link rel="prefetch" href="/assets/js/43.c991e7ce.js"><link rel="prefetch" href="/assets/js/44.10bcec94.js"><link rel="prefetch" href="/assets/js/45.00da06c9.js"><link rel="prefetch" href="/assets/js/46.4851382a.js"><link rel="prefetch" href="/assets/js/47.3ec1ef3d.js"><link rel="prefetch" href="/assets/js/48.6561d811.js"><link rel="prefetch" href="/assets/js/49.dd59bc5f.js"><link rel="prefetch" href="/assets/js/5.c21f6997.js"><link rel="prefetch" href="/assets/js/51.d88112e4.js"><link rel="prefetch" href="/assets/js/52.6f78cd2e.js"><link rel="prefetch" href="/assets/js/53.07cd16f4.js"><link rel="prefetch" href="/assets/js/54.22f398e3.js"><link rel="prefetch" href="/assets/js/55.3586124f.js"><link rel="prefetch" href="/assets/js/56.e221beb0.js"><link rel="prefetch" href="/assets/js/6.c00c814d.js"><link rel="prefetch" href="/assets/js/7.5b10a2c3.js"><link rel="prefetch" href="/assets/js/8.a4f8ac88.js"><link rel="prefetch" href="/assets/js/9.62cada5e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.44eeee96.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Cold Elm Coders</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/articles/" class="nav-link">
  Articles
</a></div><div class="nav-item"><a href="/posts/" class="nav-link router-link-active">
  Posts
</a></div><div class="nav-item"><a href="/ArchivedArticles/" class="nav-link">
  Old Articles
</a></div><div class="nav-item"><a href="/Building-a-Database-Application-in-Blazor/" class="nav-link">
  Database Application
</a></div><div class="nav-item"><a href="https://cec-blazor-examples.azurewebsites.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/articles/" class="nav-link">
  Articles
</a></div><div class="nav-item"><a href="/posts/" class="nav-link router-link-active">
  Posts
</a></div><div class="nav-item"><a href="/ArchivedArticles/" class="nav-link">
  Old Articles
</a></div><div class="nav-item"><a href="/Building-a-Database-Application-in-Blazor/" class="nav-link">
  Database Application
</a></div><div class="nav-item"><a href="https://cec-blazor-examples.azurewebsites.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>My Posts</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/posts/" aria-current="page" class="sidebar-link">Posts</a></li><li><a href="/posts/For-ForEach-in-Blazor.html" class="sidebar-link">For and ForEach loops in Blazor Components</a></li><li><a href="/posts/Blazor-Async-UI-Events.html" class="sidebar-link">Blazor Async Behaviour on UI Events</a></li><li><a href="/posts/DBContexts-In-Transient-Services.html" aria-current="page" class="active sidebar-link">No to DbContexts in Transient Services</a></li><li><a href="/posts/XML-XSD-Serialization.html" class="sidebar-link">DotNetCore XML/XSD Serialization</a></li><li><a href="/posts/Notification-Service-Pattern.html" class="sidebar-link">Blazor Notification Service Pattern</a></li><li><a href="/posts/DynamicCss.html" class="sidebar-link">Blazor Dynamic Stylesheets</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>While it seems reasonable to use a DBContext in Transient Services, DON'T.</p> <p>Why? Surely making the service IDisposable and disposing the context in Disposing works. The answer is yes, it will be disposed, but only when the Services Container is Disposed.</p> <p>When a Transient Service is requested, the Services Container creates an instance of the object, passes a reference to the caller and forgets about it. It doesn't retain a reference as it won't need it again - for every request it creates a new instance. The object instance is cleaned up by the garbage collector when the component using it is disposed. However, if the Transient Service is made IDisposable, the Service Container retains a reference to the object instance and only disposes of it when the Service Container itself is disposed.</p> <p>The net result is that if you use the Transient Service 100 times in a user session, you will have 100 instances of the Transient Service in the Service Container awaiting disposal.</p> <p>The solution is to use the IDbContextFactory<TContext> service.</TContext></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/posts/Blazor-Async-UI-Events.html" class="prev">
        Blazor Async Behaviour on UI Events
      </a></span> <span class="next"><a href="/posts/XML-XSD-Serialization.html">
        DotNetCore XML/XSD Serialization
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.cabad5b2.js" defer></script><script src="/assets/js/3.3d8b86b8.js" defer></script><script src="/assets/js/50.98d6ed4c.js" defer></script>
  </body>
</html>
