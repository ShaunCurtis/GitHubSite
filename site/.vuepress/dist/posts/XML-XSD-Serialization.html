<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DotNetCore XML/XSD Serialization | Cold Elm Coders</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.44eeee96.css" as="style"><link rel="preload" href="/assets/js/app.705bab84.js" as="script"><link rel="preload" href="/assets/js/3.3d8b86b8.js" as="script"><link rel="preload" href="/assets/js/62.92a7b31b.js" as="script"><link rel="prefetch" href="/assets/js/1.3b0fc1ec.js"><link rel="prefetch" href="/assets/js/10.a274dc46.js"><link rel="prefetch" href="/assets/js/11.162f7736.js"><link rel="prefetch" href="/assets/js/12.c4b3a8d5.js"><link rel="prefetch" href="/assets/js/13.b0705d6f.js"><link rel="prefetch" href="/assets/js/14.ed289394.js"><link rel="prefetch" href="/assets/js/15.bf766836.js"><link rel="prefetch" href="/assets/js/16.453dde69.js"><link rel="prefetch" href="/assets/js/17.74b9ed2b.js"><link rel="prefetch" href="/assets/js/18.38f53189.js"><link rel="prefetch" href="/assets/js/19.c596b300.js"><link rel="prefetch" href="/assets/js/20.543b188f.js"><link rel="prefetch" href="/assets/js/21.423fb27b.js"><link rel="prefetch" href="/assets/js/22.962d6381.js"><link rel="prefetch" href="/assets/js/23.b1e07735.js"><link rel="prefetch" href="/assets/js/24.cacf26a0.js"><link rel="prefetch" href="/assets/js/25.492c595a.js"><link rel="prefetch" href="/assets/js/26.6b042c3b.js"><link rel="prefetch" href="/assets/js/27.9c50acf7.js"><link rel="prefetch" href="/assets/js/28.764d32b1.js"><link rel="prefetch" href="/assets/js/29.be2b70f1.js"><link rel="prefetch" href="/assets/js/30.42910210.js"><link rel="prefetch" href="/assets/js/31.26e3d1e9.js"><link rel="prefetch" href="/assets/js/32.1e6ecadb.js"><link rel="prefetch" href="/assets/js/33.9b154746.js"><link rel="prefetch" href="/assets/js/34.5427d1d1.js"><link rel="prefetch" href="/assets/js/35.681677e6.js"><link rel="prefetch" href="/assets/js/36.6fd5f336.js"><link rel="prefetch" href="/assets/js/37.a7ed8fa6.js"><link rel="prefetch" href="/assets/js/38.ba355455.js"><link rel="prefetch" href="/assets/js/39.054e13a7.js"><link rel="prefetch" href="/assets/js/4.0476436c.js"><link rel="prefetch" href="/assets/js/40.449dda82.js"><link rel="prefetch" href="/assets/js/41.a6dd6973.js"><link rel="prefetch" href="/assets/js/42.0503b052.js"><link rel="prefetch" href="/assets/js/43.9c2645c5.js"><link rel="prefetch" href="/assets/js/44.9bf4f13b.js"><link rel="prefetch" href="/assets/js/45.367a1724.js"><link rel="prefetch" href="/assets/js/46.d31912a6.js"><link rel="prefetch" href="/assets/js/47.30d1eb6e.js"><link rel="prefetch" href="/assets/js/48.a148ebfc.js"><link rel="prefetch" href="/assets/js/49.485434fc.js"><link rel="prefetch" href="/assets/js/5.c21f6997.js"><link rel="prefetch" href="/assets/js/50.057a2daf.js"><link rel="prefetch" href="/assets/js/51.1c5467b3.js"><link rel="prefetch" href="/assets/js/52.2ed963c3.js"><link rel="prefetch" href="/assets/js/53.d02f3f05.js"><link rel="prefetch" href="/assets/js/54.3e733c53.js"><link rel="prefetch" href="/assets/js/55.88a10339.js"><link rel="prefetch" href="/assets/js/56.b8f7b696.js"><link rel="prefetch" href="/assets/js/57.ea24f9ed.js"><link rel="prefetch" href="/assets/js/58.e25f5c66.js"><link rel="prefetch" href="/assets/js/59.766b01b6.js"><link rel="prefetch" href="/assets/js/6.c00c814d.js"><link rel="prefetch" href="/assets/js/60.76d2b297.js"><link rel="prefetch" href="/assets/js/61.f1613395.js"><link rel="prefetch" href="/assets/js/63.70c9e811.js"><link rel="prefetch" href="/assets/js/7.fc4b414b.js"><link rel="prefetch" href="/assets/js/8.a4f8ac88.js"><link rel="prefetch" href="/assets/js/9.62cada5e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.44eeee96.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Cold Elm Coders</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/articles/" class="nav-link">
  Articles
</a></div><div class="nav-item"><a href="/posts/" class="nav-link router-link-active">
  Posts
</a></div><div class="nav-item"><a href="/ArchivedArticles/" class="nav-link">
  Old Articles
</a></div><div class="nav-item"><a href="/Building-a-Database-Application-in-Blazor/" class="nav-link">
  Database Application
</a></div><div class="nav-item"><a href="https://cec-blazor-examples.azurewebsites.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/articles/" class="nav-link">
  Articles
</a></div><div class="nav-item"><a href="/posts/" class="nav-link router-link-active">
  Posts
</a></div><div class="nav-item"><a href="/ArchivedArticles/" class="nav-link">
  Old Articles
</a></div><div class="nav-item"><a href="/Building-a-Database-Application-in-Blazor/" class="nav-link">
  Database Application
</a></div><div class="nav-item"><a href="https://cec-blazor-examples.azurewebsites.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo Site
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>My Posts</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/posts/" aria-current="page" class="sidebar-link">Posts</a></li><li><a href="/posts/For-ForEach-in-Blazor.html" class="sidebar-link">For and ForEach loops in Blazor Components</a></li><li><a href="/posts/Blazor-Async-UI-Events.html" class="sidebar-link">Blazor Async Behaviour on UI Events</a></li><li><a href="/posts/DBContexts-In-Transient-Services.html" class="sidebar-link">No to DbContexts in Transient Services</a></li><li><a href="/posts/XML-XSD-Serialization.html" aria-current="page" class="active sidebar-link">DotNetCore XML/XSD Serialization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/posts/XML-XSD-Serialization.html#building-the-classes" class="sidebar-link">Building the Classes</a></li><li class="sidebar-sub-header"><a href="/posts/XML-XSD-Serialization.html#import-code" class="sidebar-link">Import Code</a></li></ul></li><li><a href="/posts/Notification-Service-Pattern.html" class="sidebar-link">Blazor Notification Service Pattern</a></li><li><a href="/posts/DynamicCss.html" class="sidebar-link">Blazor Dynamic Stylesheets</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dotnetcore-xml-xsd-serialization"><a href="#dotnetcore-xml-xsd-serialization" class="header-anchor">#</a> DotNetCore XML/XSD Serialization</h1> <p>There are plenty of articles on the web showing you how to serialize/Deserialize XML - some good, but most just re-gurgitation of the same content.  I'm not going to do that here.  Almost nobody covers how to do it quickly in scenarios where you have a XSD XML definition file.</p> <p><a href="https://github.com/ShaunCurtis/GPXReader" target="_blank" rel="noopener noreferrer">There's a Github Repository here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to accompany this article.</p> <p>To demonstrate the process we're going to import GPX files.  These are XML formatted files with a <em>gpx</em> extension.  <a href="https://www.topografix.com/GPX/1/1/" target="_blank" rel="noopener noreferrer">The detailed XSD definition is here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>One look at the definition will tell you how complex and detailed the GPX standard is, and how much effort would be required to code and test the classes manually.  Luckily Microsoft provide a little known tool to automate the process, buried away in the Windows SDK - <em>XSD.exe</em>.</p> <h2 id="building-the-classes"><a href="#building-the-classes" class="header-anchor">#</a> Building the Classes</h2> <ol><li>Set up a bare bones DotNetCore console project (if you use Visual Studio the IDE will do some clever XSD to class associations for you).</li> <li>Get the XSD file and add it to a subfolder - <a href="https://www.topografix.com/GPX/1/1/gpx.xsd" target="_blank" rel="noopener noreferrer">GPX.xsd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - in this case <em>Gpx</em>.</li> <li>Find XSD.exe.  It's in the Windows SDK - at the moment in my case its in <em>C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.8 Tools</em>.</li> <li>Open a console/powershell window, and change to the <em>XSD.exe</em> directory.</li> <li>Run <em>XSD.exe</em> against the xsd file.  Note I've set the output to the input directory.</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token punctuation">.</span>\xsd<span class="token punctuation">.</span>exe <span class="token string">&quot;D:\Documents\GitHub\GPXReader\Gpx\gpx.xsd&quot;</span> <span class="token operator">/</span>c <span class="token operator">/</span>outputdir:<span class="token string">&quot;D:\Documents\GitHub\GpxReader\Gpx&quot;</span>
</code></pre></div><p>The result should be (I've added the separation ============= to make it clearer):</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">PS</span> C:\Program Files <span class="token punctuation">(</span>x86<span class="token punctuation">)</span>\Microsoft SDKs\Windows\v10<span class="token punctuation">.</span>0A\bin\NETFX 4<span class="token punctuation">.</span>8 Tools&gt; <span class="token punctuation">.</span>\xsd<span class="token punctuation">.</span>exe <span class="token string">&quot;D:\Documents\GitHub\GPXReader\Gpx\gpx.xsd&quot;</span> <span class="token operator">/</span>c <span class="token operator">/</span>outputdir:<span class="token string">&quot;D:\Documents\GitHub\GPXReader\Gpx&quot;</span>

==========================================================
Microsoft <span class="token punctuation">(</span>R<span class="token punctuation">)</span> Xml Schemas<span class="token operator">/</span>DataTypes support utility
<span class="token namespace">[Microsoft (R) .NET Framework, Version 4.8.3928.0]</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> Microsoft Corporation<span class="token punctuation">.</span> All rights reserved<span class="token punctuation">.</span>
Writing file <span class="token string">'D:\Documents\GitHub\GPXReader\Gpx\gpx.cs'</span><span class="token punctuation">.</span>

===========================================================
<span class="token function">PS</span> C:\Program Files <span class="token punctuation">(</span>x86<span class="token punctuation">)</span>\Microsoft SDKs\Windows\v10<span class="token punctuation">.</span>0A\bin\NETFX 4<span class="token punctuation">.</span>8 Tools&gt;
</code></pre></div><p>In the project you should now see:</p> <p><img src="https://github.com/ShaunCurtis/GPXReader/blob/master/images/GPX-class.png?raw=true" alt="gpxclass"></p> <p>Don't be tempted into a renaming exercice (I don't like those class names either!).  Think about your code maintainence process if the definition gets updated.</p> <h2 id="import-code"><a href="#import-code" class="header-anchor">#</a> Import Code</h2> <p>We now need a simple Importer Class to show we're importing data correctly.  The methods are all <code>static</code> and use streams because <code>XmlSerializer</code> uses streams not strings.</p> <p><code>ReadFile</code> - there are two versions:</p> <ol><li>Creates a <code>StreamReader</code> to get the import file.</li> <li>Creates an <code>XmlSerializer</code> object with the correct object type and XSD definition.</li> <li>Runs <code>Deserialise</code>, casting the result to the correct object type.</li> <li>Object disposal is handled by <code>using</code>.</li></ol> <p><code>WriteFile</code>:</p> <ol><li>Creates a <code>StreamWriter</code> to accept the <code>XmlSerializer</code> output - points to the output file.</li> <li>Creates an <code>XmlSerializer</code> object with the correct object type and XSD definition.</li> <li>Runs <code>Serialize</code>, outputting to the <code>StreamWriter</code>.</li> <li>Flushes the <code>StreamWriter</code> to write data to the file.</li> <li>Object disposal is handled by <code>using</code>.</li></ol> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>Serialization</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">GPXReader</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GPXReader</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">gpxType</span> <span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> url<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">gpxType</span> gpxdata <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">StreamReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamReader</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>AbsolutePath<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token class-name">XmlSerializer</span> serializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlSerializer</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">gpxType</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;http://www.topografix.com/GPX/1/1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    gpxdata <span class="token operator">=</span> serializer<span class="token punctuation">.</span><span class="token function">Deserialize</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token class-name">gpxType</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;An Error has occurred accessing file </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">url<span class="token punctuation">.</span>AbsolutePath</span><span class="token punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Environment<span class="token punctuation">.</span>NewLine</span><span class="token punctuation">}</span></span><span class="token string"> Details:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Environment<span class="token punctuation">.</span>NewLine</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">e<span class="token punctuation">.</span>StackTrace</span><span class="token punctuation">}</span></span><span class="token string">.&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> gpxdata<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">//  Bool return version</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> url<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token class-name">gpxType</span> gpxdata<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            gpxdata <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">StreamReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamReader</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>AbsolutePath<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token class-name">XmlSerializer</span> serializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlSerializer</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">gpxType</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;http://www.topografix.com/GPX/1/1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    gpxdata <span class="token operator">=</span> serializer<span class="token punctuation">.</span><span class="token function">Deserialize</span><span class="token punctuation">(</span>reader<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token class-name">gpxType</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;An Error has occurred accessing file </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">url<span class="token punctuation">.</span>AbsolutePath</span><span class="token punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Environment<span class="token punctuation">.</span>NewLine</span><span class="token punctuation">}</span></span><span class="token string"> Details:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Environment<span class="token punctuation">.</span>NewLine</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">e<span class="token punctuation">.</span>StackTrace</span><span class="token punctuation">}</span></span><span class="token string">.&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">WriteFile</span><span class="token punctuation">(</span><span class="token class-name">gpxType</span> data<span class="token punctuation">,</span> <span class="token class-name">Uri</span> url<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">StreamWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamWriter</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>AbsolutePath<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token class-name">XmlSerializer</span> serializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlSerializer</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">gpxType</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;http://www.topografix.com/GPX/1/1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    serializer<span class="token punctuation">.</span><span class="token function">Serialize</span><span class="token punctuation">(</span>writer<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    writer<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;An Error has occurred accessing file </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">url<span class="token punctuation">.</span>AbsolutePath</span><span class="token punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Environment<span class="token punctuation">.</span>NewLine</span><span class="token punctuation">}</span></span><span class="token string"> Details:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Environment<span class="token punctuation">.</span>NewLine</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">e<span class="token punctuation">.</span>StackTrace</span><span class="token punctuation">}</span></span><span class="token string">.&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>I've added a fairly complex gpx file (imported from Google Maps) to the project.</p> <p>Finally we build a simple <code>Program</code> like this:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">GPXReader</span>
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;GPX Reader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">var</span></span> data <span class="token operator">=</span> GPXReader<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Uri</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;D:/Documents/GitHub/GPXReader/gpx/Test.gpx&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Read file&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Set Break point here to view the imported file</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Writing output file&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            GPXReader<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Uri</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;D:/Documents/GitHub/GPXReader/gpx/output.gpx&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Complete&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The project looks like this:</p> <p><img src="https://github.com/ShaunCurtis/GPXReader/blob/master/images/project-view.png?raw=true" alt="data view"></p> <h3 id="testing-output"><a href="#testing-output" class="header-anchor">#</a> Testing Output</h3> <p>Run the project with a breakpoint set and explore the created <code>data</code> object.</p> <p><img src="https://github.com/ShaunCurtis/GPXReader/blob/master/images/Object-Local.png?raw=true" alt="data view"></p> <p>That's it.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/posts/DBContexts-In-Transient-Services.html" class="prev">
        No to DbContexts in Transient Services
      </a></span> <span class="next"><a href="/posts/Notification-Service-Pattern.html">
        Blazor Notification Service Pattern
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.705bab84.js" defer></script><script src="/assets/js/3.3d8b86b8.js" defer></script><script src="/assets/js/62.92a7b31b.js" defer></script>
  </body>
</html>
