(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{517:function(t,e,a){"use strict";a.r(e);var n=a(26),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"chapter-1-project-design-and-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chapter-1-project-design-and-structure"}},[t._v("#")]),t._v(" Chapter 1 - Project Design and Structure")]),t._v(" "),a("p",[t._v("You've built the out-of-the-box template, done some exploratory coding.  You're now ready to work on your first application.")]),t._v(" "),a("p",[t._v("Where do you start?  It's a little daunting.  You expect to make mistakes, take the odd wrong road, need some help....")]),t._v(" "),a("p",[t._v("This primer is intended to provide guidance on how to get up and running.  It's aimed primarily at the small to medium sized project with one or two developers working on it.  It takes a very practical approach: we starti with the standard Blazor Server template and turn it into a properly structured and testable solution.")]),t._v(" "),a("h1",{attrs:{id:"methodology"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#methodology"}},[t._v("#")]),t._v(" Methodology")]),t._v(" "),a("p",[t._v("There are many programming methodologies that you could apply.  I'm going to use my own fairly simple three domain model.")]),t._v(" "),a("p",[a("img",{attrs:{src:"/siteimages/articles/DB-Primer/methodology.png",alt:"Methodologies"}})]),t._v(" "),a("p",[t._v("What are we trying to achieve?")]),t._v(" "),a("p",[t._v("When you build your own application you can build it in whatever way you wish.  You know it intimately, so where to go when you have bugs and problem.  But what is someone else is going to maintain it?  What happens when you come back to it a year later?  How do you test new functionality and updates?  How do you change to a different data source?  How do you put a new frontend on the application?")]),t._v(" "),a("p",[t._v("The answer is to apply some basic principles.")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("Separation of Concerns")]),t._v(".  Code classes should only be responsible for a definable "),a("em",[t._v("unit of work")]),t._v(".  UI code should not include database access functionality.")]),t._v(" "),a("li",[a("strong",[t._v("Inversion of Control")]),t._v(".  Higher level classes should not depend on lower level classes.  A business logic class should not contain a specific declaration of a database access class.")]),t._v(" "),a("li",[a("strong",[t._v("Project Dependancy Enforcement")]),t._v(".  In my framework Separate Projects for the UI, Core and Data domains, with project level defined project to project dependancies.  You can't code a business logic class with a dependancy on a Data Domain class.")])]),t._v(" "),a("p",[t._v("The heart of the application is the "),a("em",[t._v("Core Domain")]),t._v(": Core = Application and Business logic code.  Notice that it only depends on Blazor and third party libraries: there's no dependancies on the other application domains.  The "),a("em",[t._v("Data Domain")]),t._v(" provides the interface into the data storage.  The "),a("em",[t._v("UI Domain")]),t._v(" contains all the UI code.")]),t._v(" "),a("p",[t._v("Core to Data Domain communications is through interfaces.  In our application Core domain business logic classes make data requests through the "),a("code",[t._v("IDataConnector")]),t._v(" interface.  This talks to the Data Domain through an "),a("code",[t._v("IDataBroker")]),t._v(" interface defined by the Data Domain.")]),t._v(" "),a("p",[t._v("This all plugs together using the Blazor Services container.")]),t._v(" "),a("p",[t._v("Let's look at what our application services definition will look like:")]),t._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Data Domain Code")]),t._v("\n    services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token generic-method"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddSingleton")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("WeatherDataStore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token generic-method"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddSingleton")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IDataBroker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ServerDataBroker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Core Domain code")]),t._v("\n    services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token generic-method"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddScoped")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IDataConnector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" DataConnector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token generic-method"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddScoped")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("WeatherForecastViewService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("Our business logic class is "),a("code",[t._v("WeatherForecastViewService")]),t._v(".  The "),a("code",[t._v("WeatherForecastViewService")]),t._v(" constructor defines an "),a("code",[t._v("IDataConnector")]),t._v(" argument. When "),a("code",[t._v("WeatherForecastViewService")]),t._v(" is instanciated by the Services Container, it injects the instance of "),a("code",[t._v("IDataConnector")]),t._v(" defined for the Service Container, in our case "),a("code",[t._v("DataConnector")]),t._v(".    The "),a("code",[t._v("DataConnector")]),t._v(" constructor defines an "),a("code",[t._v("IDataBroker")]),t._v(" argument, and "),a("code",[t._v("ServerDataBroker")]),t._v(" a "),a("code",[t._v("WeatherDataStore")]),t._v(" arguement, ....")]),t._v(" "),a("p",[t._v("The benefits in this design become apparent when we need to change out the Data Store.  We'll see this when we implement a WASM version of the site, and when we add support for a SQL database data store.")]),t._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Data Domain Code")]),t._v("\n    services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token generic-method"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddSingleton")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("WeatherDataStore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token generic-method"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddSingleton")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IDataBroker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" APIDataBroker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// No Core Domain code - all in the Server Controller")]),t._v("\n")])])]),a("h1",{attrs:{id:"the-initial-solution"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-initial-solution"}},[t._v("#")]),t._v(" The Initial Solution")]),t._v(" "),a("p",[t._v("Create a new solution using the standard Blazor Server project with no authenication - BlazorDB.")]),t._v(" "),a("p",[t._v('you should now have a solution with one "Web" project.')]),t._v(" "),a("p",[t._v("Create the following projects in the solution:")]),t._v(" "),a("ol",[a("li",[a("p",[a("em",[t._v("BlazorDB.Core")]),t._v(" using the "),a("em",[t._v("Class Library")]),t._v(" template.")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("BlazorDB.Data")]),t._v(" using the "),a("em",[t._v("Class Library")]),t._v(" template.")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("BlazorDB.UI")]),t._v(" using the "),a("em",[t._v("Razor Class Library")]),t._v(" template.")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("BlazorDB.Test")]),t._v(" using the "),a("em",[t._v("xUnit Test Project")]),t._v(" template.")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("BlazorDB.Web")]),t._v(" using the "),a("em",[t._v("Blazor Server App")]),t._v(" template.")])]),t._v(" "),a("li",[a("p",[t._v("Clear the contents from projects 1-4.")])]),t._v(" "),a("li",[a("p",[t._v("Leave "),a("em",[t._v("BlazorDB.Web")]),t._v(" as is.")])]),t._v(" "),a("li",[a("p",[t._v("Set "),a("em",[t._v("BlazorDB.Web")]),t._v(" as the startup project.")])])]),t._v(" "),a("p",[t._v("You should now have a solution that looks like:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/siteimages/articles/DB-Primer/article-1-solution.png",alt:"Solution"}})]),t._v(" "),a("p",[t._v("Add dependancies to the Data and UI projects back to Core. Add dependancies to the Test project to all three projects.")]),t._v(" "),a("p",[a("img",{attrs:{src:"/siteimages/articles/DB-Primer/project-dependancies.png",alt:"Project Dependancies"}})])])}),[],!1,null,null,null);e.default=s.exports}}]);